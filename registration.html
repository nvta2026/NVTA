<!DOCTYPE html>
<html lang="bn">
<head>
    <link rel="manifest" href="/NVTA/manifest.json">
<meta name="theme-color" content="#0f172a">

<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>নিবন্ধন</title>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <style>
        :root {
            --primary-color: #4a6bff;
            --secondary-color: #f5f7ff;
            --white: #fff;
            --error-color: #ff4d4d;
            --text-color: #333;
            --border-color: #ddd;
            --background-color: var(--secondary-color);
            --card-background: var(--white);
            --header-bg: var(--white);
            --footer-bg: var(--white);
            --footer-text: var(--text-color);
        }
        @media (prefers-color-scheme: dark) {
            :root {
                --secondary-color: #1a1a1a;
                --white: #2d2d2d;
                --text-color: #f0f0f0;
                --border-color: #444;
                --background-color: #121212;
                --card-background: var(--white);
                --header-bg: #1a1a1a;
                --footer-bg: #1a1a1a;
                --footer-text: #f0f0f0;
            }
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Kalpurush', 'Siyam Rupali', sans-serif;
        }
        
        body {
            background: var(--background-color);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            padding: 0;
            transition: background 0.3s ease, color 0.3s ease;
            overflow: auto;
            position: relative;
        }
        
        /* Background Animation */
        #background-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.6;
        }
        
        .particle {
            position: absolute;
            border-radius: 50%;
            background: linear-gradient(135deg, #2ecc71, #3498db);
            animation: float 15s infinite linear;
            opacity: 0.3;
        }
        
        @keyframes float {
            0% {
                transform: translateY(0) translateX(0) rotate(0deg);
                opacity: 0.3;
            }
            25% {
                transform: translateY(-20px) translateX(10px) rotate(90deg);
                opacity: 0.5;
            }
            50% {
                transform: translateY(0) translateX(20px) rotate(180deg);
                opacity: 0.3;
            }
            75% {
                transform: translateY(20px) translateX(10px) rotate(270deg);
                opacity: 0.5;
            }
            100% {
                transform: translateY(0) translateX(0) rotate(360deg);
                opacity: 0.3;
            }
        }
        
        /* Header Styles */
        header {
            background-color: var(--header-bg);
            padding: 5px 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            text-align: center;
            transition: background 0.3s ease;
            flex-shrink: 0;
            border-bottom-left-radius: 30px;
            border-bottom-right-radius: 30px;
            border-bottom: 1px solid #2ecc71;
            position: relative;
            z-index: 1;
        }

        .header-image {
            max-height: 35px;
            width: auto;
        }
        
        /* Main Content Styles */
        main {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding: 20px;
            overflow-y: auto;
            position: relative;
            z-index: 1;
        }
        
        /* Footer Styles */
        footer {
            background-color: var(--footer-bg);
            color: var(--footer-text);
            text-align: center;
            font-size: 12px;
            padding: 15px 20px;
            transition: background 0.3s ease, color 0.3s ease;
            flex-shrink: 0;
            border-top-left-radius: 30px;
            border-top-right-radius: 30px;
            border-top: 1px solid #2ecc71;
            position: relative;
            z-index: 1;
        }
        
        /* Toast notification */
        .toast {
            position: fixed;
            top: 50px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #2ecc71, #3498db);
            color: white;
            padding: 12px 24px;
            border-radius: 4px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 1000;
            display: inline-block;
            text-align: center;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 90%;
        }

        .toast.show {
            opacity: 1;
        }
        
        .hidden-content {
            visibility: hidden;
        }

        /* Registration Form Styles */
        .form-container {
            max-width: 1200px;
            width: 100%;
            margin: 20px auto;
            border-radius: 12px;
            padding: 25px;
            background: var(--card-background);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border: 1px solid var(--border-color);
            transition: background 0.3s ease;
        }
        
        .form-header {
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #2c3e9e;
        }
        
        .form-header h1 {
            color: var(--text-color);
            font-size: 24px;
            margin-bottom: 8px;
            font-weight: 700;
        }
        
        .form-header p {
            color: var(--text-color);
            opacity: 0.8;
            font-size: 14px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .form-body {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }
        
        .form-column {
            padding: 10px;
        }
        
        .form-group {
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }
        
        .form-group label {
            width: 220px;
            font-weight: 600;
            color: var(--text-color);
            font-size: 14px;
            padding-right: 12px;
            text-align: right;
        }
        
        .required::after {
            content: " *";
            color: #e74c3c;
            font-weight: bold;
        }
        
        .form-group input, 
        .form-group select {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 14px;
            height: 38px;
            background-color: var(--card-background);
            color: var(--text-color);
        }
        
        .form-group input:focus, 
        .form-group select:focus {
            border-color: #2c3e9e;
            outline: none;
        }
        
        .form-group input::placeholder {
            color: #999;
            font-size: 13px;
        }
        
        .date-input-group {
            flex: 1;
            display: flex;
            gap: 5px;
        }
        
        .date-input-group input {
            width: 33%;
            text-align: center;
            padding: 8px 5px;
            background-color: var(--card-background);
            color: var(--text-color);
            border: 1px solid var(--border-color);
        }
        
        .address-section {
            grid-column: 1 / -1;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
            padding: 20px;
        }
        
        .address-columns {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 30px;
        }
        
        .address-title {
            color: #2c3e9e;
            font-size: 18px;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid #2c3e9e;
            font-weight: 700;
        }
        
        .same-address {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            padding: 10px 15px;
            border-radius: 4px;
        }
        
        .same-address label {
            font-weight: 600;
            display: flex;
            align-items: center;
            color: var(--text-color);
            cursor: pointer;
            font-size: 14px;
            margin: 0;
        }
        
        .same-address input {
            margin-right: 10px;
            width: 16px;
            height: 16px;
            cursor: pointer;
        }
        
        .password-section {
            grid-column: 1 / -1;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
            padding: 20px;
        }
        
        .password-row {
            display: flex;
            gap: 30px;
            justify-content: center;
        }
        
        .password-group {
            display: flex;
            align-items: center;
            flex: 1;
            max-width: 600px;
        }
        
        .password-group label {
            width: 220px;
            font-weight: 600;
            color: var(--text-color);
            font-size: 14px;
            padding-right: 12px;
            text-align: right;
            margin-bottom: 0;
        }
        
        .password-group input {
            flex: 1;
            padding: 10px 14px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 14px;
            height: 40px;
            min-width: 250px;
            background-color: var(--card-background);
            color: var(--text-color);
        }
        
        .form-footer {
            grid-column: 1 / -1;
            text-align: center;
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }
        
        .form-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 15px;
        }
        
        button[type="submit"] {
            padding: 12px 35px;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            background: #2c3e9e;
            color: white;
            transition: background-color 0.3s;
            position: relative;
        }
        
        button[type="submit"]:hover {
            background: #1a237e;
        }
        
        button[type="submit"]:disabled {
            background: #cccccc;
            cursor: not-allowed;
        }
        
        .loading-spinner {
            display: none;
            border: 2px solid #f3f3f3;
            border-top: 2px solid #2c3e9e;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
        }
        
        @keyframes spin {
            0% { transform: translateY(-50%) rotate(0deg); }
            100% { transform: translateY(-50%) rotate(360deg); }
        }
        
        .login-link {
            color: var(--text-color);
            opacity: 0.8;
            font-size: 13px;
            text-align: center;
            margin-top: 10px;
            padding-top: 10px;
        }
        
        .login-link a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 600;
        }
        
        .login-link a:hover {
            text-decoration: underline;
        }
        
        .copyright {
            color: var(--text-color);
            opacity: 0.8;
            font-size: 13px;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px dashed var(--border-color);
        }
        
        .section-divider {
            grid-column: 1 / -1;
            height: 1px;
            background-color: var(--border-color);
            margin: 15px 0;
        }
        
        /* Custom Alert Modal */
        .alert-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .alert-content {
            background: var(--card-background);
            padding: 40px;
            border-radius: 10px;
            text-align: center;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .success-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 20px;
            background-color: #27ae60;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .success-icon::after {
            content: "✓";
            color: white;
            font-size: 40px;
            font-weight: bold;
        }
        
        .alert-content h3 {
            color: #2c3e9e;
            font-size: 24px;
            margin-bottom: 10px;
        }
        
        .alert-content p {
            color: var(--text-color);
            font-size: 16px;
            margin-bottom: 25px;
        }
        
        .alert-ok-btn {
            padding: 12px 30px;
            background-color: #2c3e9e;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .alert-ok-btn:hover {
            background-color: #1a237e;
        }
        
        .error-message {
            color: #e74c3c;
            font-size: 12px;
            margin-top: 5px;
            display: none;
        }
        
        .nid-input {
            letter-spacing: 1px;
        }
        
        .bengali-input {
            font-family: 'Kalpurush', 'Siyam Rupali', 'SolaimanLipi', sans-serif;
        }

        /* ছবি সম্পর্কিত নোটিশ */
        .photo-notice {
            grid-column: 1 / -1;
            background-color: rgba(255, 249, 230, 0.1);
            border: 1px solid #ffcc00;
            border-radius: 6px;
            padding: 15px;
            margin: 20px 0;
            text-align: center;
        }
        
        .photo-notice h4 {
            color: #e67e22;
            margin-bottom: 8px;
            font-size: 16px;
        }
        
        .photo-notice p {
            color: #d35400;
            font-size: 14px;
            font-weight: 600;
        }
        
        /* ইমেইল ভ্যালিডেশন নোটিশ */
        .email-notice {
            font-size: 12px;
            color: var(--text-color);
            opacity: 0.7;
            margin-top: 3px;
            display: block;
            font-style: italic;
        }
        
        /* মোবাইল রেস্পন্সিভ স্টাইল */
        @media (max-width: 1200px) {
            .form-container {
                max-width: 95%;
            }
        }
        
        @media (max-width: 992px) {
            .form-body {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .form-group label {
                width: 200px;
            }
            
            .address-columns {
                gap: 25px;
            }
            
            .password-row {
                flex-direction: column;
                gap: 15px;
            }
            
            .password-group {
                max-width: 100%;
            }
            
            .password-group label {
                width: 200px;
            }
        }
        
        @media (max-width: 768px) {
            main {
                padding: 10px;
            }
            
            .form-container {
                padding: 15px;
            }
            
            .form-group {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .form-group label {
                width: 100%;
                text-align: left;
                margin-bottom: 5px;
                padding-right: 0;
            }
            
            .form-group input, 
            .form-group select {
                width: 100%;
            }
            
            .date-input-group {
                width: 100%;
            }
            
            .same-address {
                padding: 10px;
            }
            
            .form-buttons {
                flex-direction: column;
                align-items: center;
                gap: 10px;
            }
            
            button[type="submit"] {
                width: 100%;
                max-width: 300px;
            }
            
            .loading-spinner {
                right: 10px;
            }
            
            .form-header h1 {
                font-size: 20px;
            }
            
            .password-group {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .password-group label {
                width: 100%;
                text-align: left;
                margin-bottom: 5px;
            }
            
            .password-group input {
                min-width: 100%;
                width: 100%;
            }
            
            .address-title {
                font-size: 16px;
            }
            
            .address-columns {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .alert-content {
                padding: 30px 20px;
            }
            
            .success-icon {
                width: 60px;
                height: 60px;
            }
            
            .success-icon::after {
                font-size: 30px;
            }
            
            .alert-content h3 {
                font-size: 20px;
            }
            
            .photo-notice {
                padding: 12px;
                margin: 15px 0;
            }
            
            .photo-notice h4 {
                font-size: 15px;
            }
            
            .photo-notice p {
                font-size: 13px;
            }
        }
        
        @media (max-width: 480px) {
            .form-header h1 {
                font-size: 18px;
            }
            
            .form-header p {
                font-size: 13px;
            }
            
            .date-input-group {
                gap: 5px;
            }
            
            .date-input-group input {
                width: 100%;
            }
        }
        
        @media (max-width: 360px) {
            .form-container {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Background Animation -->
    <div id="background-animation"></div>

    <header class="hidden-content">
        <img src="https://blogger.googleusercontent.com/img/a/AVvXsEivqTIaHdAT5pCu40npVAhBQUB7v15cU-vog8HUrrsluvCpu3Q4kRsQ2XiX2pnPi441r1CIxxxgLe9HPVq8lVPQKg22UyoVEQZdm_JRehypwRK8WWfDQY45SCFonpHDeLrTr0u2Qhk1RnVew6cLpcWrUN9FfLdv6f_sG9KwJi1EpHbRs5DGk4ZlRIqL" alt="Social Service Logo" class="header-image">
    </header>

    <main class="hidden-content">
        <div class="form-container">
            <div class="form-header">
                <h1>নিবন্ধন সদস্য ফরম</h1>
                <p>নিচের ফরমটি পূরণ করে নিবন্ধন প্রক্রিয়া সম্পন্ন করুন।</p>
            </div>
            
            <form id="registrationForm">
                <div class="form-body">
                    <!-- প্রথম কলাম -->
                    <div class="form-column">
                        <div class="form-group">
                            <label for="name" class="required">নামঃ</label>
                            <input type="text" id="name" name="name" placeholder="আপনার পূর্ণ নাম" required class="bengali-input">
                        </div>
                        
                        <div class="form-group">
                            <label for="fatherName" class="required">পিতার নামঃ</label>
                            <input type="text" id="fatherName" name="fatherName" placeholder="পিতার পূর্ণ নাম" required class="bengali-input">
                        </div>
                        
                        <div class="form-group">
                            <label for="motherName" class="required">মাতার নামঃ</label>
                            <input type="text" id="motherName" name="motherName" placeholder="মাতার পূর্ণ নাম" required class="bengali-input">
                        </div>
                        
                        <div class="form-group">
                            <label for="birthDate" class="required">জন্ম তারিখঃ</label>
                            <div class="date-input-group">
                                <input type="text" id="birthDay" name="birthDay" placeholder="দিন" maxlength="2" pattern="[0-9]{1,2}" required inputmode="numeric">
                                <input type="text" id="birthMonth" name="birthMonth" placeholder="মাস" maxlength="2" pattern="[0-9]{1,2}" required inputmode="numeric">
                                <input type="text" id="birthYear" name="birthYear" placeholder="বছর" maxlength="4" pattern="[0-9]{4}" required inputmode="numeric">
                            </div>
                            <div class="error-message" id="birthDateError"></div>
                        </div>
                        
                        <div class="form-group">
                            <label for="religion" class="required">ধর্মঃ</label>
                            <select id="religion" name="religion" required class="bengali-input">
                                <option value="">নির্বাচন করুন</option>
                                <option value="ইসলাম">ইসলাম</option>
                                <option value="অন্যান্য">অন্যান্য</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="profession" class="required">পেশাঃ</label>
                            <select id="profession" name="profession" required class="bengali-input">
                                <option value="">নির্বাচন করুন</option>
                                <option value="শিক্ষার্থী">শিক্ষার্থী</option>
                                <option value="শিক্ষক">শিক্ষক</option>
                                <option value="ব্যবসায়ী">ব্যবসায়ী</option>
                                <option value="সরকারি চাকুরী">সরকারি চাকুরী</option>
                                <option value="বেসরকারি চাকুরী">বেসরকারি চাকুরী</option>
                                <option value="কৃষক">কৃষক</option>
                                <option value="অন্যান্য">অন্যান্য</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- দ্বিতীয় কলাম -->
                    <div class="form-column">
                        <div class="form-group">
                            <label for="nid" class="required">জাতীয় পরিচয়পত্র/জন্ম সনদ নম্বরঃ</label>
                            <input type="text" id="nid" name="nid" placeholder="জাতীয় পরিচয়পত্র নম্বর" class="nid-input" required inputmode="numeric">
                            <div class="error-message" id="nidError">শুধুমাত্র ইংরেজি সংখ্যা লিখুন</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="nationality" class="required">জাতীয়তাঃ</label>
                            <select id="nationality" name="nationality" required class="bengali-input">
                                <option value="">নির্বাচন করুন</option>
                                <option value="বাংলাদেশী">বাংলাদেশী</option>
                                <option value="অন্যান্য">অন্যান্য</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="maritalStatus" class="required">বৈবাহিক অবস্থাঃ</label>
                            <select id="maritalStatus" name="maritalStatus" required class="bengali-input">
                                <option value="">নির্বাচন করুন</option>
                                <option value="অবিবাহিত">অবিবাহিত</option>
                                <option value="বিবাহিত">বিবাহিত</option>
                                <option value="তালাকপ্রাপ্ত">তালাকপ্রাপ্ত</option>
                                <option value="বিধবা/বিপত্নীক">বিধবা/বিপত্নীক</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="bloodGroup">রক্তের গ্রুপঃ</label>
                            <select id="bloodGroup" name="bloodGroup" class="bengali-input">
                                <option value="">নির্বাচন করুন</option>
                                <option value="A+">এ+</option>
                                <option value="A-">এ-</option>
                                <option value="B+">বি+</option>
                                <option value="B-">বি-</option>
                                <option value="O+">ও+</option>
                                <option value="O-">ও-</option>
                                <option value="AB+">এবি+</option>
                                <option value="AB-">এবি-</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="education" class="required">শিক্ষাগত যোগ্যতাঃ</label>
                            <select id="education" name="education" required class="bengali-input">
                                <option value="">নির্বাচন করুন</option>
                                <option value="প্রাথমিক">প্রাথমিক</option>
                                <option value="মাধ্যমিক">মাধ্যমিক</option>
                                <option value="উচ্চ মাধ্যমিক">উচ্চ মাধ্যমিক</option>
                                <option value="ডিপ্লোমা">ডিপ্লোমা</option>
                                <option value="স্নাতক">স্নাতক</option>
                                <option value="স্নাতকোত্তর">স্নাতকোত্তর</option>
                                <option value="পিএইচডি">পিএইচডি</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="mobile" class="required">মোবাইল নাম্বারঃ</label>
                            <input type="tel" id="mobile" name="mobile" placeholder="0123456789" pattern="[0-9]{11}" required inputmode="numeric">
                        </div>
                        
                        <!-- ইমেইল ফিল্ড যোগ করা হয়েছে (For Forgot Password) -->
                        <div class="form-group">
                            <label for="email" class="required">ইমেইলঃ</label>
                            <input type="email" id="email" name="email" placeholder="আপনার ইমেইল ঠিকানা" required>
                            <span class="email-notice">পাসওয়ার্ড রিসেটের জন্য প্রয়োজনীয়</span>
                            <div class="error-message" id="emailError"></div>
                        </div>
                        
                        <!-- ছবি আপলোড অপশন সরানো হয়েছে -->
                    </div>
                    
                    <div class="section-divider"></div>
                    
                    <!-- নমিনি তথ্য -->
                    <div class="form-column">
                        <div class="form-group">
                            <label for="nomineeName" class="required">নমিনির নামঃ</label>
                            <input type="text" id="nomineeName" name="nomineeName" placeholder="নমিনির পূর্ণ নাম" required class="bengali-input">
                        </div>
                        
                        <div class="form-group">
                            <label for="nomineeRelation" class="required">নমিনির সাথে সম্পর্কঃ</label>
                            <select id="nomineeRelation" name="nomineeRelation" required class="bengali-input">
                                <option value="">নির্বাচন করুন</option>
                                <option value="পিতা">পিতা</option>
                                <option value="মাতা">মাতা</option>
                                <option value="স্বামী/স্ত্রী">স্বামী/স্ত্রী</option>
                                <option value="পুত্র">পুত্র</option>
                                <option value="কন্যা">কন্যা</option>
                                <option value="ভাই">ভাই</option>
                                <option value="বোন">বোন</option>
                                <option value="অন্যান্য">অন্যান্য</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="nomineeNid" class="required">নমিনির জাতীয় পরিচয়পত্র নম্বরঃ</label>
                            <input type="text" id="nomineeNid" name="nomineeNid" placeholder="জাতীয় পরিচয়পত্র নম্বর" class="nid-input" required inputmode="numeric">
                            <div class="error-message" id="nomineeNidError">শুধুমাত্র ইংরেজি সংখ্যা লিখুন</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="nomineeBirthDate" class="required">নমিনির জন্ম তারিখঃ</label>
                            <div class="date-input-group">
                                <input type="text" id="nomineeBirthDay" name="nomineeBirthDay" placeholder="দিন" maxlength="2" pattern="[0-9]{1,2}" required inputmode="numeric">
                                <input type="text" id="nomineeBirthMonth" name="nomineeBirthMonth" placeholder="মাস" maxlength="2" pattern="[0-9]{1,2}" required inputmode="numeric">
                                <input type="text" id="nomineeBirthYear" name="nomineeBirthYear" placeholder="বছর" maxlength="4" pattern="[0-9]{4}" required inputmode="numeric">
                            </div>
                            <div class="error-message" id="nomineeBirthDateError"></div>
                        </div>
                        
                        <!-- নমিনির ছবি আপলোড অপশন সরানো হয়েছে -->
                    </div>

                    <!-- ঠিকানা সেকশন -->
                    <div class="address-section">
                        <div class="address-columns">
                            <!-- স্থায়ী ঠিকানা -->
                            <div class="address-column">
                                <h3 class="address-title">স্থায়ী ঠিকানাঃ</h3>
                                
                                <div class="form-group">
                                    <label for="permanentVillage" class="required">গ্রাম/মহল্লাঃ</label>
                                    <input type="text" id="permanentVillage" name="permanentVillage" placeholder="গ্রাম/মহল্লার নাম" required class="bengali-input">
                                </div>
                                
                                <div class="form-group">
                                    <label for="permanentPostOffice" class="required">ডাকঘরঃ</label>
                                    <input type="text" id="permanentPostOffice" name="permanentPostOffice" placeholder="ডাকঘরের নাম" required class="bengali-input">
                                </div>
                                
                                <div class="form-group">
                                    <label for="permanentUpazila" class="required">উপজেলাঃ</label>
                                    <input type="text" id="permanentUpazila" name="permanentUpazila" placeholder="উপজেলার নাম" required class="bengali-input">
                                </div>
                                
                                <div class="form-group">
                                    <label for="permanentDistrict" class="required">জেলাঃ</label>
                                    <input type="text" id="permanentDistrict" name="permanentDistrict" placeholder="জেলার নাম" required class="bengali-input">
                                </div>
                            </div>
                            
                            <!-- বর্তমান ঠিকানা -->
                            <div class="address-column">
                                <h3 class="address-title">বর্তমান ঠিকানাঃ</h3>
                                
                                <div class="same-address">
                                    <label>
                                        <input type="checkbox" id="sameAsPermanent" name="sameAsPermanent">
                                        স্থায়ী ঠিকানা এবং বর্তমান ঠিকানা একই
                                    </label>
                                </div>
                                
                                <div class="form-group">
                                    <label for="currentVillage" class="required">গ্রাম/মহল্লাঃ</label>
                                    <input type="text" id="currentVillage" name="currentVillage" placeholder="গ্রাম/মহল্লার নাম" required class="bengali-input">
                                </div>
                                
                                <div class="form-group">
                                    <label for="currentPostOffice" class="required">ডাকঘরঃ</label>
                                    <input type="text" id="currentPostOffice" name="currentPostOffice" placeholder="ডাকঘরের নাম" required class="bengali-input">
                                </div>
                                
                                <div class="form-group">
                                    <label for="currentUpazila" class="required">উপজেলাঃ</label>
                                    <input type="text" id="currentUpazila" name="currentUpazila" placeholder="উপজেলার নাম" required class="bengali-input">
                                </div>
                                
                                <div class="form-group">
                                    <label for="currentDistrict" class="required">জেলাঃ</label>
                                    <input type="text" id="currentDistrict" name="currentDistrict" placeholder="জেলার নাম" required class="bengali-input">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ছবি সম্পর্কিত নোটিশ -->
                    <div class="photo-notice">
                        <h4>গুরুত্বপূর্ণ নির্দেশনা</h4>
                        <p>সদস্য ছবি এবং নমিনির ছবি সংগঠনে যোগাযোগ করে জমা দিতে হবে!</p>
                    </div>
                    
                    <!-- পাসওয়ার্ড সেকশন -->
                    <div class="password-section">
                        <h3 class="address-title" style="border-bottom: none; margin-bottom: 15px;">নিরাপত্তা তথ্য</h3>
                        <div class="password-row">
                            <div class="password-group">
                                <label for="password" class="required">নতুন পাসওয়ার্ডঃ</label>
                                <input type="password" id="password" name="password" placeholder="পাসওয়ার্ড লিখুন (ন্যূনতম ৬ অক্ষর)" required minlength="6">
                            </div>
                            
                            <div class="password-group">
                                <label for="confirmPassword" class="required">কনফার্ম পাসওয়ার্ডঃ</label>
                                <input type="password" id="confirmPassword" name="confirmPassword" placeholder="পুনরায় পাসওয়ার্ড লিখুন" required minlength="6">
                            </div>
                        </div>
                        <p style="text-align: center; margin-top: 10px; color: var(--text-color); opacity: 0.8; font-size: 13px;">পাসওয়ার্ডে অন্তত ৬টি অক্ষর থাকা আবশ্যক</p>
                    </div>
                    
                    <!-- ফুটার -->
                    <div class="form-footer">
                        <div class="form-buttons">
                            <button type="submit" class="submit-btn" id="submitBtn">
                                নিবন্ধন সম্পন্ন করুন
                                <div class="loading-spinner" id="loadingSpinner"></div>
                            </button>
                        </div>
                        
                        <p class="login-link">ইতিমধ্যে অ্যাকাউন্ট আছে? <a href="login.html">লগইন করুন</a></p>
                    </div>
                </div>
            </form>
        </div>
    </main>

    <footer class="hidden-content">
        <p>এনভিটিএ © ২০২৬ | সর্বস্বত্ব সংরক্ষিত</p>
    </footer>

    <!-- Custom Success Alert Modal -->
    <div class="alert-modal" id="successAlert">
        <div class="alert-content">
            <div class="success-icon"></div>
            <h3>নিবন্ধন সফল হয়েছে!</h3>
            <p>আপনার নিবন্ধন সফলভাবে সম্পন্ন হয়েছে।</p>
            <button class="alert-ok-btn" id="alertOkBtn">ঠিক আছে</button>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <script>
    // Background Animation
    function createBackgroundAnimation() {
        const container = document.getElementById('background-animation');
        const particleCount = 15;
        
        for (let i = 0; i < particleCount; i++) {
            const particle = document.createElement('div');
            particle.classList.add('particle');
            
            const size = Math.random() * 60 + 20;
            particle.style.width = `${size}px`;
            particle.style.height = `${size}px`;
            
            const posX = Math.random() * 100;
            const posY = Math.random() * 100;
            particle.style.left = `${posX}%`;
            particle.style.top = `${posY}%`;
            
            const duration = Math.random() * 10 + 15;
            particle.style.animationDuration = `${duration}s`;
            
            const delay = Math.random() * 5;
            particle.style.animationDelay = `${delay}s`;
            
            container.appendChild(particle);
        }
    }

    createBackgroundAnimation();

    // Firebase কনফিগারেশন
    const firebaseConfig = {
        apiKey: "AIzaSyBnUqarL-c8oEA52EPBCUdoz67kzvsDnM0",
        authDomain: "nvta-f70ed.firebaseapp.com",
        projectId: "nvta-f70ed",
        storageBucket: "nvta-f70ed.firebasestorage.app",
        messagingSenderId: "832906232424",
        appId: "1:832906232424:web:df35b6c489c9c9c03ef1dd"
    };

    // Firebase ইনিশিয়ালাইজ
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const auth = firebase.auth();

    // Show content
    const header = document.querySelector('header');
    const main = document.querySelector('main');
    const footer = document.querySelector('footer');

    // Check if user is already logged in
    auth.onAuthStateChanged(user => {
        if (user) {
            // User is signed in, but we won't redirect anywhere
            // Registration成功后我们会手动logout并redirect到login.html
        } else {
            // User is not signed in, show the content
            header.classList.remove('hidden-content');
            main.classList.remove('hidden-content');
            footer.classList.remove('hidden-content');
        }
    });

    // Toast function from login page
    function showToast(message, isSuccess = true) {
        const toast = document.getElementById('toast');
        toast.textContent = message;
        toast.style.background = isSuccess ? 'linear-gradient(135deg, #2ecc71, #3498db)' : '#f44336';
        toast.classList.add('show');

        setTimeout(() => {
            toast.classList.remove('show');
        }, 3000);
    }

    // তারিখ ফিল্ডের জন্য ভ্যালিডেশন
    const birthDay = document.getElementById('birthDay');
    const birthMonth = document.getElementById('birthMonth');
    const birthYear = document.getElementById('birthYear');
    const nomineeBirthDay = document.getElementById('nomineeBirthDay');
    const nomineeBirthMonth = document.getElementById('nomineeBirthMonth');
    const nomineeBirthYear = document.getElementById('nomineeBirthYear');
    
    // NID ফিল্ড
    const nidField = document.getElementById('nid');
    const nomineeNidField = document.getElementById('nomineeNid');
    
    // নতুন ইমেইল ফিল্ড (ফরগট পাসওয়ার্ডের জন্য)
    const emailField = document.getElementById('email');
    
    // সাবমিট বাটন এবং লোডিং স্পিনার
    const submitBtn = document.getElementById('submitBtn');
    const loadingSpinner = document.getElementById('loadingSpinner');
    const successAlert = document.getElementById('successAlert');
    const alertOkBtn = document.getElementById('alertOkBtn');
    
    // ইমেইল ভ্যালিডেশন ফাংশন (ফরগট পাসওয়ার্ড সাপোর্টের জন্য)
    function validateEmail(email) {
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return emailRegex.test(email);
    }
    
    // ইমেইল ইনপুট ভ্যালিডেশন
    emailField.addEventListener('blur', function() {
        const email = this.value.trim();
        const errorField = document.getElementById('emailError');
        
        if (!email) {
            errorField.textContent = 'ইমেইল আবশ্যক (ফরগট পাসওয়ার্ডের জন্য)';
            errorField.style.display = 'block';
            this.style.borderColor = '#e74c3c';
            return;
        }
        
        if (!validateEmail(email)) {
            errorField.textContent = 'সঠিক ইমেইল ঠিকানা লিখুন (যেমন: example@gmail.com)';
            errorField.style.display = 'block';
            this.style.borderColor = '#e74c3c';
        } else {
            errorField.style.display = 'none';
            this.style.borderColor = '';
        }
    });
    
    // ইমেইল ফিল্ড ফোকাস হলে হিন্ট
    emailField.addEventListener('focus', function() {
        const errorField = document.getElementById('emailError');
        errorField.style.display = 'none';
        this.style.borderColor = '#2c3e9e';
    });
    
    // তারিখের ভ্যালিডেশন ফাংশন
    function validateDate(dayField, monthField, yearField, errorFieldId, fieldType = '') {
        const day = parseInt(dayField.value) || 0;
        const month = parseInt(monthField.value) || 0;
        const year = parseInt(yearField.value) || 0;
        const currentYear = new Date().getFullYear();
        const errorField = document.getElementById(errorFieldId);
        
        errorField.style.display = 'none';
        dayField.style.borderColor = '';
        monthField.style.borderColor = '';
        yearField.style.borderColor = '';
        
        if (day < 1 || day > 31) {
            errorField.textContent = 'দিন 1 থেকে 31 এর মধ্যে হতে হবে';
            errorField.style.display = 'block';
            dayField.style.borderColor = '#e74c3c';
            return false;
        }
        
        if (month < 1 || month > 12) {
            errorField.textContent = 'মাস 1 থেকে 12 এর মধ্যে হতে হবে';
            errorField.style.display = 'block';
            monthField.style.borderColor = '#e74c3c';
            return false;
        }
        
        if (year < 1950 || year > currentYear) {
            errorField.textContent = `বছর 1950 থেকে ${currentYear} এর মধ্যে হতে হবে`;
            errorField.style.display = 'block';
            yearField.style.borderColor = '#e74c3c';
            return false;
        }
        
        const daysInMonth = new Date(year, month, 0).getDate();
        if (day > daysInMonth) {
            errorField.textContent = `${fieldType} মাস ${month} এর জন্য সর্বোচ্চ ${daysInMonth} দিন হতে পারে`;
            errorField.style.display = 'block';
            dayField.style.borderColor = '#e74c3c';
            return false;
        }
        
        return true;
    }
    
    function limitInputLength(input, maxLength, maxValue = null) {
        if (input.value.length > maxLength) {
            input.value = input.value.slice(0, maxLength);
        }
        
        if (maxValue !== null && input.value) {
            const numValue = parseInt(input.value) || 0;
            if (numValue > maxValue) {
                input.value = maxValue.toString();
            }
        }
    }
    
    birthDay.addEventListener('input', function() {
        limitInputLength(this, 2, 31);
        validateDate(birthDay, birthMonth, birthYear, 'birthDateError', '');
    });
    
    birthMonth.addEventListener('input', function() {
        limitInputLength(this, 2, 12);
        validateDate(birthDay, birthMonth, birthYear, 'birthDateError', '');
    });
    
    birthYear.addEventListener('input', function() {
        limitInputLength(this, 4);
        validateDate(birthDay, birthMonth, birthYear, 'birthDateError', '');
    });
    
    nomineeBirthDay.addEventListener('input', function() {
        limitInputLength(this, 2, 31);
        validateDate(nomineeBirthDay, nomineeBirthMonth, nomineeBirthYear, 'nomineeBirthDateError', 'নমিনির');
    });
    
    nomineeBirthMonth.addEventListener('input', function() {
        limitInputLength(this, 2, 12);
        validateDate(nomineeBirthDay, nomineeBirthMonth, nomineeBirthYear, 'nomineeBirthDateError', 'নমিনির');
    });
    
    nomineeBirthYear.addEventListener('input', function() {
        limitInputLength(this, 4);
        validateDate(nomineeBirthDay, nomineeBirthMonth, nomineeBirthYear, 'nomineeBirthDateError', 'নমিনির');
    });
    
    function validateNID(nidField, errorFieldId) {
        const nid = nidField.value;
        const errorField = document.getElementById(errorFieldId);
        
        errorField.style.display = 'none';
        nidField.style.borderColor = '';
        
        const englishNumberRegex = /^[0-9]+$/;
        
        if (!englishNumberRegex.test(nid)) {
            errorField.textContent = 'শুধুমাত্র ইংরেজি সংখ্যা লিখুন';
            errorField.style.display = 'block';
            nidField.style.borderColor = '#e74c3c';
            return false;
        }
        
        if (nid.length < 10 || nid.length > 17) {
            errorField.textContent = 'জাতীয় পরিচয়পত্র নম্বর ১০ থেকে ১৭ অঙ্কের মধ্যে হতে হবে';
            errorField.style.display = 'block';
            nidField.style.borderColor = '#e74c3c';
            return false;
        }
        
        return true;
    }
    
    nidField.addEventListener('input', function(e) {
        this.value = this.value.replace(/[^0-9]/g, '');
        limitInputLength(this, 17);
        validateNID(this, 'nidError');
    });
    
    nomineeNidField.addEventListener('input', function(e) {
        this.value = this.value.replace(/[^0-9]/g, '');
        limitInputLength(this, 17);
        validateNID(this, 'nomineeNidError');
    });
    
    nidField.addEventListener('focus', function() {
        this.setAttribute('inputmode', 'numeric');
        if (/Mobi|Android/i.test(navigator.userAgent)) {
            this.type = 'number';
        }
    });
    
    nomineeNidField.addEventListener('focus', function() {
        this.setAttribute('inputmode', 'numeric');
        if (/Mobi|Android/i.test(navigator.userAgent)) {
            this.type = 'number';
        }
    });
    
    function autoTab(current, nextFieldId) {
        if (current.value.length >= current.maxLength) {
            document.getElementById(nextFieldId).focus();
        }
    }
    
    birthDay.addEventListener('input', function() {
        autoTab(this, 'birthMonth');
    });
    
    birthMonth.addEventListener('input', function() {
        autoTab(this, 'birthYear');
    });
    
    nomineeBirthDay.addEventListener('input', function() {
        autoTab(this, 'nomineeBirthMonth');
    });
    
    nomineeBirthMonth.addEventListener('input', function() {
        autoTab(this, 'nomineeBirthYear');
    });
    
    [birthDay, birthMonth, birthYear, nomineeBirthDay, nomineeBirthMonth, nomineeBirthYear].forEach(field => {
        field.addEventListener('keypress', function(e) {
            if (e.key < '0' || e.key > '9') {
                e.preventDefault();
            }
        });
        
        field.addEventListener('input', function() {
            this.value = this.value.replace(/[^0-9]/g, '');
        });
        
        field.addEventListener('focus', function() {
            this.setAttribute('inputmode', 'numeric');
        });
    });
    
    async function saveRegistrationData(formData) {
        try {
            loadingSpinner.style.display = 'block';
            submitBtn.disabled = true;
            
            const memberId = 'NVTA-' + Date.now() + '-' + Math.floor(Math.random() * 1000);
            
            const userCredential = await auth.createUserWithEmailAndPassword(
                formData.email, 
                formData.password
            );
            
            const user = userCredential.user;
            
            const defaultPhotoLink = 'https://nvta-f70ed.firebasestorage.app/images/default_photo.jpg';
            
            const registrationData = {
                memberId: memberId,
                name: formData.name,
                fatherName: formData.fatherName,
                motherName: formData.motherName,
                birthDate: `${formData.birthDay}/${formData.birthMonth}/${formData.birthYear}`,
                religion: formData.religion,
                profession: formData.profession,
                nid: formData.nid,
                nationality: formData.nationality,
                maritalStatus: formData.maritalStatus,
                bloodGroup: formData.bloodGroup,
                education: formData.education,
                mobile: formData.mobile,
                email: formData.email,
                systemEmail: `${memberId}@nvta.com`,
                
                memberPhotoLink: defaultPhotoLink,
                
                nomineeName: formData.nomineeName,
                nomineeRelation: formData.nomineeRelation,
                nomineeNid: formData.nomineeNid,
                nomineeBirthDate: `${formData.nomineeBirthDay}/${formData.nomineeBirthMonth}/${formData.nomineeBirthYear}`,
                
                nomineePhotoLink: defaultPhotoLink,
                
                permanentAddress: {
                    village: formData.permanentVillage,
                    postOffice: formData.permanentPostOffice,
                    upazila: formData.permanentUpazila,
                    district: formData.permanentDistrict
                },
                currentAddress: {
                    village: formData.currentVillage,
                    postOffice: formData.currentPostOffice,
                    upazila: formData.currentUpazila,
                    district: formData.currentDistrict
                },
                
                registrationDate: new Date().toISOString(),
                userId: user.uid,
                status: 'active',
                photoSubmitted: false,
                photoSubmissionNote: 'সদস্যকে সংগঠনে যোগাযোগ করে ছবি জমা দিতে হবে',
                
                forgotPasswordEnabled: true,
                emailVerified: false
            };
            
            await db.collection('Registration').doc(memberId).set(registrationData);
            
            console.log('রেজিস্ট্রেশন সফল:', memberId);
            console.log('ইমেইল (ফরগট পাসওয়ার্ডের জন্য):', formData.email);
            console.log('সিস্টেম ইমেইল:', `${memberId}@nvta.com`);
            console.log('ছবি জমা দেওয়ার জন্য নির্দেশনা:', 'সদস্যকে সংগঠনে যোগাযোগ করতে হবে');
            
            return { 
                success: true, 
                memberId: memberId,
                email: formData.email,
                note: 'ছবি জমা দেওয়ার জন্য সংগঠনে যোগাযোগ করুন'
            };
            
        } catch (error) {
            console.error('রেজিস্ট্রেশন ব্যর্থ:', error);
            throw error;
        } finally {
            loadingSpinner.style.display = 'none';
            submitBtn.disabled = false;
        }
    }
    
    function showSuccessAlert() {
        successAlert.style.display = 'flex';
        
        // Alert দেখানোর 3 সেকেন্ড পর logout করিয়ে login.html এ রিডাইরেক্ট
        setTimeout(() => {
            auth.signOut().then(() => {
                window.location.href = 'login.html';
            }).catch(error => {
                // যদি logout fail হয়, তবুও login.html এ নিয়ে যাবে
                window.location.href = 'login.html';
            });
        }, 3000);
    }
    
    alertOkBtn.addEventListener('click', function() {
        successAlert.style.display = 'none';
        // OK বাটন ক্লিক করলে logout করিয়ে সাথে সাথে login.html এ নিয়ে যাবে
        auth.signOut().then(() => {
            window.location.href = 'login.html';
        }).catch(error => {
            window.location.href = 'login.html';
        });
    });
    
    document.getElementById('registrationForm').addEventListener('submit', async function(event) {
        event.preventDefault();
        
        if (!validateDate(birthDay, birthMonth, birthYear, 'birthDateError', '')) {
            birthDay.focus();
            return;
        }
        
        const day = parseInt(birthDay.value) || 0;
        const month = parseInt(birthMonth.value) || 0;
        const year = parseInt(birthYear.value) || 0;
        const birthDate = new Date(year, month - 1, day);
        const today = new Date();
        let age = today.getFullYear() - birthDate.getFullYear();
        const monthDiff = today.getMonth() - birthDate.getMonth();
        
        if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
            age--;
        }
        
        if (age < 16) {
            showToast('আপনার বয়স কমপক্ষে ১৬ বছর হতে হবে', false);
            birthDay.focus();
            return;
        }
        
        if (!validateDate(nomineeBirthDay, nomineeBirthMonth, nomineeBirthYear, 'nomineeBirthDateError', 'নমিনির')) {
            nomineeBirthDay.focus();
            return;
        }
        
        if (!validateNID(nidField, 'nidError')) {
            nidField.focus();
            return;
        }
        
        if (!validateNID(nomineeNidField, 'nomineeNidError')) {
            nomineeNidField.focus();
            return;
        }
        
        const email = emailField.value.trim();
        const errorField = document.getElementById('emailError');
        
        if (!email) {
            errorField.textContent = 'ইমেইল আবশ্যক (ফরগট পাসওয়ার্ডের জন্য)';
            errorField.style.display = 'block';
            emailField.style.borderColor = '#e74c3c';
            emailField.focus();
            return;
        }
        
        if (!validateEmail(email)) {
            errorField.textContent = 'সঠিক ইমেইল ঠিকানা লিখুন (যেমন: example@gmail.com)';
            errorField.style.display = 'block';
            emailField.style.borderColor = '#e74c3c';
            emailField.focus();
            return;
        }
        
        const password = document.getElementById('password').value;
        const confirmPassword = document.getElementById('confirmPassword').value;
        
        if (password !== confirmPassword) {
            showToast('পাসওয়ার্ড মিলেনি। আবার চেষ্টা করুন।', false);
            document.getElementById('password').focus();
            return;
        }
        
        if (password.length < 6) {
            showToast('পাসওয়ার্ডে অন্তত ৬টি অক্ষর থাকতে হবে!', false);
            document.getElementById('password').focus();
            return;
        }
        
        const mobile = document.getElementById('mobile').value;
        const mobileRegex = /^01[3-9]\d{8}$/;
        if (!mobileRegex.test(mobile)) {
            showToast('সঠিক মোবাইল নম্বর দিন (০১XXXXXXXXX ফরম্যাটে)', false);
            document.getElementById('mobile').focus();
            return;
        }
        
        try {
            const usersRef = db.collection('Registration');
            const querySnapshot = await usersRef
                .where('email', '==', email)
                .get();
            
            if (!querySnapshot.empty) {
                errorField.textContent = 'এই ইমেইল ইতিমধ্যে নিবন্ধিত আছে';
                errorField.style.display = 'block';
                emailField.style.borderColor = '#e74c3c';
                emailField.focus();
                return;
            }
        } catch (error) {
            console.log('ইমেইল চেকিং এ ত্রুটি:', error);
        }
        
        const formData = {
            name: document.getElementById('name').value,
            fatherName: document.getElementById('fatherName').value,
            motherName: document.getElementById('motherName').value,
            birthDay: day,
            birthMonth: month,
            birthYear: year,
            religion: document.getElementById('religion').value,
            profession: document.getElementById('profession').value,
            nid: nidField.value,
            nationality: document.getElementById('nationality').value,
            maritalStatus: document.getElementById('maritalStatus').value,
            bloodGroup: document.getElementById('bloodGroup').value,
            education: document.getElementById('education').value,
            mobile: mobile,
            email: email,
            
            nomineeName: document.getElementById('nomineeName').value,
            nomineeRelation: document.getElementById('nomineeRelation').value,
            nomineeNid: nomineeNidField.value,
            nomineeBirthDay: parseInt(nomineeBirthDay.value) || 0,
            nomineeBirthMonth: parseInt(nomineeBirthMonth.value) || 0,
            nomineeBirthYear: parseInt(nomineeBirthYear.value) || 0,
            
            permanentVillage: document.getElementById('permanentVillage').value,
            permanentPostOffice: document.getElementById('permanentPostOffice').value,
            permanentUpazila: document.getElementById('permanentUpazila').value,
            permanentDistrict: document.getElementById('permanentDistrict').value,
            
            currentVillage: document.getElementById('currentVillage').value,
            currentPostOffice: document.getElementById('currentPostOffice').value,
            currentUpazila: document.getElementById('currentUpazila').value,
            currentDistrict: document.getElementById('currentDistrict').value,
            
            password: password
        };
        
        try {
            const result = await saveRegistrationData(formData);
            
            if (result.success) {
                // সফলতার পপআপ দেখান
                document.querySelector('.alert-content h3').textContent = 'নিবন্ধন সফল হয়েছে!';
                document.querySelector('.alert-content p').textContent = 'আপনার নিবন্ধন সফলভাবে সম্পন্ন হয়েছে।';
                showSuccessAlert();
                
                this.reset();
                document.getElementById('sameAsPermanent').checked = false;
                
                document.querySelectorAll('.error-message').forEach(error => {
                    error.style.display = 'none';
                });
                
                const currentFields = [
                    'currentVillage', 'currentPostOffice', 
                    'currentUpazila', 'currentDistrict'
                ];
                currentFields.forEach(fieldId => {
                    document.getElementById(fieldId).disabled = false;
                });
            }
        } catch (error) {
            let errorMessage = 'নিবন্ধন ব্যর্থ হয়েছে। দয়া করে আবার চেষ্টা করুন।';
            
            if (error.code === 'auth/email-already-in-use') {
                errorMessage = 'এই ইমেইল ইতিমধ্যে নিবন্ধিত আছে। অন্য ইমেইল ব্যবহার করুন।';
            } else if (error.code === 'auth/invalid-email') {
                errorMessage = 'অবৈধ ইমেইল ঠিকানা। সঠিক ইমেইল লিখুন।';
            } else if (error.code === 'auth/weak-password') {
                errorMessage = 'পাসওয়ার্ড খুবই দুর্বল। শক্তিশালী পাসওয়ার্ড ব্যবহার করুন।';
            } else if (error.code === 'permission-denied') {
                errorMessage = 'অনুমতি অস্বীকৃত হয়েছে। Firebase কনফিগারেশন চেক করুন।';
            }
            
            showToast(errorMessage, false);
            console.error('Error details:', error);
        }
    });
    
    document.getElementById('sameAsPermanent').addEventListener('change', function() {
        const currentFields = [
            'currentVillage', 'currentPostOffice', 
            'currentUpazila', 'currentDistrict'
        ];
        
        const permanentFields = [
            'permanentVillage', 'permanentPostOffice', 
            'permanentUpazila', 'permanentDistrict'
        ];
        
        if (this.checked) {
            for (let i = 0; i < permanentFields.length; i++) {
                const permanentValue = document.getElementById(permanentFields[i]).value;
                document.getElementById(currentFields[i]).value = permanentValue;
                document.getElementById(currentFields[i]).disabled = true;
            }
        } else {
            currentFields.forEach(fieldId => {
                document.getElementById(fieldId).disabled = false;
            });
        }
    });
    
    const permanentFields = [
        'permanentVillage', 'permanentPostOffice', 
        'permanentUpazila', 'permanentDistrict'
    ];
    
    permanentFields.forEach(fieldId => {
        document.getElementById(fieldId).addEventListener('input', function() {
            if (document.getElementById('sameAsPermanent').checked) {
                const currentFieldId = fieldId.replace('permanent', 'current');
                document.getElementById(currentFieldId).value = this.value;
            }
        });
    });
    
    document.getElementById('password').addEventListener('input', function() {
        const password = this.value;
        const strengthIndicator = document.getElementById('password-strength');
        
        if (!strengthIndicator) {
            const indicator = document.createElement('div');
            indicator.id = 'password-strength';
            indicator.style.marginTop = '5px';
            indicator.style.fontSize = '12px';
            this.parentElement.appendChild(indicator);
        }
        
        let strengthText = '';
        let strengthColor = '#e74c3c';
        
        if (password.length === 0) {
            strengthText = '';
        } else if (password.length < 6) {
            strengthText = 'দুর্বল (কমপক্ষে ৬ অক্ষর প্রয়োজন)';
            strengthColor = '#e74c3c';
        } else if (password.length < 8) {
            strengthText = 'মাঝারি';
            strengthColor = '#f39c12';
        } else {
            strengthText = 'ভালো';
            strengthColor = '#27ae60';
        }
        
        if (strengthIndicator) {
            strengthIndicator.textContent = strengthText;
            strengthIndicator.style.color = strengthColor;
            strengthIndicator.style.fontWeight = 'bold';
        }
    });
    
    if (/Mobi|Android/i.test(navigator.userAgent)) {
        const numericFields = [
            birthDay, birthMonth, birthYear,
            nomineeBirthDay, nomineeBirthMonth, nomineeBirthYear,
            nidField, nomineeNidField,
            document.getElementById('mobile')
        ];
        
        numericFields.forEach(field => {
            if (field) {
                field.type = 'number';
                field.setAttribute('inputmode', 'numeric');
            }
        });
    }
    
    emailField.addEventListener('input', function() {
        const email = this.value;
        if (email && !email.includes('@')) {
            const errorField = document.getElementById('emailError');
            errorField.textContent = 'ইমেইলে @ চিহ্ন অবশ্যই থাকতে হবে';
            errorField.style.display = 'block';
        } else {
            const errorField = document.getElementById('emailError');
            errorField.style.display = 'none';
        }
    });
</script>
    <script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('/NVTA/sw.js');
}
</script>
</body>
</html>
